# شرح مفصّل — **Static Network Route** (المسار الثابت لشبكة)

سنغطي هنا كل شيء عن **Static Network Route** خطوة بخطوة: ما هو، متى يُستخدم، الصيغة، أمثلة عملية، وكيف يختلف عن **Host Route**، بالإضافة لأفضل الممارسات وأوامر التشخيص.

---

## 1) ما هو **Static Network Route**؟

**Static Network Route** هو مسار ثابت يتم إدخاله يدوياً للاتصال **بشبكة كاملة** وليس مجرد مضيف واحد.

- أي العنوان هو شبكة (network) مع subnet mask > /32.
    
- مثال IPv4:
    
    ```
    192.168.20.0/24
    ```
    
    هذا المسار يشمل كل العناوين من `192.168.20.1` إلى `192.168.20.254`.
    

---

## 2) الفرق بين **Host Route** و **Network Route**

|الخاصية|Host Route|Network Route|
|---|---|---|
|قناع الشبكة|/32 (IPv4)|أي قناع أقل من /32 (مثلاً /24, /26)|
|الاستخدام|لمضيف واحد|لشبكة كاملة أو VLAN أو subnet|
|الأمثلة|192.0.2.5/32|192.168.20.0/24|
|الأولوية|أعلى غالباً|حسب AD و metric|

---

## 3) الصيغة العامة على Cisco IOS

### أ. باستخدام **next-hop IP** (أفضل طريقة)

```
ip route <network> <subnet-mask> <next-hop-ip>
```

مثال:

```
ip route 192.168.20.0 255.255.255.0 10.0.0.2
```

- أي حزمة إلى شبكة `192.168.20.0/24` ترسل إلى الراوتر التالي `10.0.0.2`.
    

### ب. باستخدام **exit-interface** (اختياري)

```
ip route 192.168.20.0 255.255.255.0 GigabitEthernet0/1
```

- يستخدم فقط إذا كانت الشبكة التالية مباشرة على هذه الواجهة.
    

### IPv6

```
ipv6 route 2001:db8:20::/64 2001:db8:1::2
```

---

## 4) أمثلة عملية

### مثال 1 — توجيه شبكة فرعية

```
ip route 172.16.10.0 255.255.255.0 10.0.0.2
```

- كل حركة إلى 172.16.10.0/24 تمر عبر next-hop `10.0.0.2`.
    

### مثال 2 — Floating static network route (مسار احتياطي)

```
ip route 192.168.50.0 255.255.255.0 10.2.2.2 250
```

- AD أعلى (250) → يُستخدم فقط إذا لم يتوفر مسار ديناميكي أفضل.
    

### مثال 3 — توجيه الشبكات عبر Null0 (blackhole)

```
ip route 10.10.0.0 255.255.0.0 Null0
```

- كل حركة لهذه الشبكة تُسقط محلياً.
    

---

## 5) سلوك الراوتر عند استخدام **Static Network Route**

1. يستقبل الحزمة.
    
2. يقلل TTL بمقدار 1.
    
3. يبحث في جدول التوجيه (RIB / FIB) لأفضل تطابق للشبكة (Longest Prefix Match).
    
4. إذا وجد Static Network Route مناسب → يرسل الحزمة إلى next-hop أو الواجهة المحددة.
    
5. يقوم **ARP lookup** أو تحويل next-hop إلى MAC على الشبكة المحلية إذا لزم الأمر.
    

> ملاحظة: **Network Route** قد تشمل عدة مضيفين، بينما **Host Route** تخص عنوان واحد فقط.

---

## 6) عند استخدام Next-Hop IP — Recursive Lookup

مثال:

```
ip route 192.168.30.0 255.255.255.0 10.0.0.2
```

- إذا 10.0.0.2 ليس على نفس الشبكة مباشرة، الراوتر يبحث عن مسار للوصول إليه → **Recursive Lookup**.
    
- إذا لم يجد → المسار يعتبر inactive.
    

---

## 7) أمور عملية ونصائح

- استخدم **next-hop IP** بدلاً من exit-interface عند الإمكان → أكثر مرونة.
    
- تأكد من عدم وجود **تداخل شبكات** (Overlapping Subnets).
    
- استخدم **floating static** كمسار احتياطي.
    
- **توثيق كل static routes** لتسهيل الصيانة.
    
- يمكن دمجها مع **policy-based routing** أو **NAT** لتوجيه خاص بالشبكات.
    

---

## 8) أوامر التشخيص

- عرض جدول التوجيه:
    

```
show ip route
show ip route 192.168.20.0
```

- التحقق من FIB / forwarding:
    

```
show ip cef 192.168.20.0
```

- التحقق من ARP:
    

```
show ip arp
```

- تتبع المسار للحزم:
    

```
traceroute 192.168.20.10
```

---

## 9) مثال عملي في سيناريو شبكة

- لديك راوتر متصل بمكتب فرع:
    
    - شبكة المستخدمين: `192.168.50.0/24`
        
    - شبكة الطابعات: `192.168.51.0/28`
        
    - وصلة للمقر الرئيسي: `10.0.0.0/30`
        

تهيئة static network routes:

```
ip route 192.168.50.0 255.255.255.0 GigabitEthernet0/1
ip route 192.168.51.0 255.255.255.240 GigabitEthernet0/1
ip route 10.0.0.0 255.255.255.252 10.0.0.2
```

> الراوتر الآن يعرف كيف يوجّه كل الشبكات إلى الوجهة الصحيحة، سواء على نفس الواجهة أو عبر next-hop.

---

## 10) ملخّص سريع

- **Static Network Route** = مسار ثابت لشبكة كاملة (subnet أو VLAN).
    
- يستخدم لإضافة مسارات يدوية خارج نطاق التوجيه الديناميكي أو لتجاوز مسار ديناميكي.
    
- صيغة أساسية:
    

```
ip route <network> <subnet-mask> <next-hop-ip|exit-interface>
```

- تحقق من صحة المسارات باستخدام `show ip route`, `show ip cef`, و`traceroute`.
    
- Host Route = /32 لمضيف واحد، Network Route = /24 أو /26 لشبكة كاملة.
    

---

إذا تحب، أقدر أسوي لك **رسم توضيحي للمقارنة بين Host Route و Network Route** + أمثلة عملية لكيفية عمل Longest Prefix Match بينهم على جدول التوجيه.

هل تحب أسوي لك الرسم والأمثلة العملية؟

[[71- Symmetric Routing]]