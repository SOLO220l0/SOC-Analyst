

شرح مفصَّل عن Internet Protocol Version 4 (IPv4)

⸻

1. نظرة عامة سريعة • IPv4 = طبقة 3 (Network Layer) في نموذج OSI. • عنوان منطقي (Logical Address) بطول 32-بت يُستخدم لتوجيه الحزم بين الشبكات. • Connectionless، best-effort, unreliable — يعني: الراوتر يوجّه الحزم لكنه ما يضمن وصولها أو ترتيبها (هذا شغل بروتوكولات أعلى مثل TCP). • العرض داخل سلايد: “Decimal Language (and Binary), Logical Address, Variable based on need, 32 Bit length, Part for Network & Part for Hosts, 4 octets”.

⸻

1. تمثيل العنوان (Dotted-Decimal وBinary) • IPv4 يعرض عادةً كـ 4 أعداد عشرية مفصولة بنقطة (كل جزء = 8 بت = أكتِت = octet). مثال: 192.168.1.10

مثال تحويل من ثنائي → عشرّي (خطوة بخطوة)

التمثيل الثنائي: 11000000.10101000.00000001.00001010 • الجزء الأول 11000000 = 128 + 64 + 0 + 0 + 0 + 0 + 0 + 0 = 192 • الثاني 10101000 = 128 + 0 + 32 + 0 + 8 + 0 + 0 + 0 = 168 • الثالث 00000001 = 0+0+0+0+0+0+0+1 = 1 • الرابع 00001010 = 0+0+0+0+8+0+2+0 = 10

النتيجة: 192.168.1.10 — هذا يوضّح كيف ننتقل بين البايت الثنائي والعرض العشري.

⸻

1. قسمة الشبكة والـ Subnet Mask وCIDR • جزء من الـ 32-بت مخصّص للشبكة وجزء للمضيفين (hosts). التقسيم يحدده قناع الشبكة (Subnet Mask) أو التدوين /prefix (CIDR). • مثال: 192.168.1.10/24 → يعني القناع /24 = 255.255.255.0 → أول 24 بت للشبكة، آخر 8 للمضيفين.

حساب الشبكة والإرسال العام (broadcast) • Network address = عملة AND بين الـ IP و الـ Mask. مثال: 192.168.1.10 AND 255.255.255.0 = 192.168.1.0 • Broadcast address = شبكتك مع كل بتات المضيف = 192.168.1.255 • عدد العناوين في /24 = 2^{8} = 256 عنوان. قابل للاستخدام = 256 - 2 = 254 (نخصم عنوان الشبكة وعنوان البث). (حساب: 2^8 = 2\times2\times… ثمانية مرات = 256).

⸻

1. مجموع عناوين IPv4 • إجمالي العناوين الممكنة = 2^{32} = 4,294,967,296. (للتأكيد: 2^{32} حسب الحساب = 4,294,967,296).

ملاحظة: عدد العناوين الفعّالة للمستخدمين أقل بسبب عناوين محجوزة (مثل الشبكات الخاصة، عناوين البث، الشبكة، والـ loopback).

⸻

1. أقسام العنوان الكاتِبة (Classful) — لمحة سريعة (تاريخي)

(في CCNA تُعرض كمرجع لكن الاستخدام العملي اليوم هو CIDR/VLSM)

- Class A: 1.0.0.0 – 126.255.255.255 • Class B: 128.0.0.0 – 191.255.255.255 • Class C: 192.0.0.0 – 223.255.255.255 • Class D: 224.0.0.0 – 239.255.255.255 (multicast) • Class E: 240.0.0.0 – 255.255.255.255 (تجريبي)

ملاحظة عملية: استخدم CIDR (مثل /24, /26) وVLSM لتقسيم الشبكات بكفاءة.

⸻

1. نطاقات العناوين الخاصة (RFC1918) • 10.0.0.0/8 • 172.16.0.0/12 • 192.168.0.0/16 تُستخدم داخل الشبكات الخاصة ولا تُوجّه مباشرة على الإنترنت بدون NAT.

⸻

1. بنية رأس (IPv4 Header) — الحقول المهمة

الـ header الأدنى طوله 20 بايت، وبعناصر مثل: • Version (4 bits) → 4 • IHL (4 bits) → طول الهيدر بالأشرطة (min = 5 → 20 بايت) • DSCP / ECN (8 bits) → QoS/تمييز الخدمة • Total Length (16 bits) → طول الحزمة (header + data) بالبايت • Identification, Flags, Fragment offset → إدارة التجزئة (fragmentation) • TTL (Time To Live) (8 bits) → يمنع الحلقات؛ كل راوتر ينقص قيمة TTL. • Protocol (8 bits) → يحدد البروتوكول الموجود في الحمولة (مثلاً TCP=6، UDP=17، ICMP=1). • Header Checksum (16 bits) → للتحقق من سلامة رأس الحزمة فقط. • Source IP (32 bits) • Destination IP (32 bits) • Options (إذا وُجدت) → قد تزيد طول الهيدر.

⸻

1. التجزئة (Fragmentation) • إذا كانت الحزمة أكبر من MTU للشبكة التالية، الراوتر قد يقسمها (fragment) إلى أجزاء أصغر، مع حقول Identification/Flags/Offset لإعادة التركيب عند الوجهة. • التجزئة لها أثر على الأداء، لذا يُفضّل ضبط MSS/TCP Path MTU Discovery لتقليل التجزئة.

⸻

1. كيف IPv4 يتعامل مع Ethernet (التكامل بين طبقة 2 و3) • عند إرسال حزمة IP داخل نفس الشبكة:
2. المضيف يتحقق إذا الوجهة في نفس الشبكة (باستخدام القناع).
3. إذا نعم → يستخدم ARP للحصول على MAC المقابل لعنوان الـ IP الوجهة.
4. يضع الـ IP Packet داخل Ethernet Frame مع Destination MAC وSource MAC ثم يرسل. • إذا الوجهة ليست في نفس الشبكة:
5. المضيف يرسل إلى Default Gateway (روتر) — يحصل على MAC البوابة عبر ARP.
6. يرسل الإطار إلى البوابة، البوابة تزيل الإطار، تنظر لحقل Destination IP، وتعيد تغليف الحزمة داخل إطار مناسب للشبكة التالية (ويمكن تغيير الـ MAC لكل قفزة).

⸻

1. أمثلة عملية (سريعة)

مثال 1 — نفس الشبكة • Host A: 192.168.1.10/24، Host B: 192.168.1.20/24
• A يرسل → يكتشف B على نفس الشبكة → ARP لعنوان 192.168.1.20 → يحصل على MAC → يبني Ethernet Frame ويرسله مباشرة.

مثال 2 — شبكة مختلفة
 • Host A: 192.168.1.10/24، Destination: 8.8.8.8
 • A يجد أن 8.8.8.8 ليس ضمن /24 → يرسل الحزمة إلى Default Gateway (مثلاً 192.168.1.1) عبر MAC البوابة → الراوتر يوجّهها للمرحلة التالية.

⸻

11) أوامر Cisco مفيدة لمشاهدة IPv4 والحالة
 • show ip interface brief  — عرض الواجهات وعناوينها.
 • show ip route — جدول التوجيه.
 • show ip arp — جدول ARP (IP ↔ MAC).
 • show interface [type/number] — حالة الواجهة، MTU، إحصاءات.
 • (لـ Layer2) show mac address-table.

⸻

12) نقاط مهمة تحفظها للامتحان / العمل العملي
 • IPv4 = 32 بت → 4 octets.
 • تعلم التحويل الثنائي ↔ عشري للأوكتِت خطوة بخطوة.
 • افهم القناع (mask) وعمليات الـ AND لتحديد عنوان الشبكة والبث.
 • عرف متى يستخدم ARP ومتى يذهب الطلب للـ gateway.
 • اعرف حقل الـ TTL وProtocol وسبب تجزئة الحزم.

⸻



[[20- قناع الشبكة (Subnet Mask)]]